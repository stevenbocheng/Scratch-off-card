rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Games collection — the main game state
    match /games/{gameId} {
      // Anyone authenticated can read
      allow read: if request.auth != null;

      // Only authenticated users can write
      // (Fine-grained array element validation isn't possible,
      //  so we rely on frontend Transactions + Cloud Functions)
      allow write: if request.auth != null;
    }

    // Cards collection — saved snapshots for sharing
    match /cards/{cardId} {
      // Anyone can read shared cards (public links)
      allow read: if true;

      // Only authenticated users can create snapshots
      allow create: if request.auth != null;

      // No updates or deletes on shared snapshots
      allow update, delete: if false;
    }
  }
}
